OHXDEN <- bind_rows(OHXDEN_I, OHXDEN_J) %>%
mutate(
tc = str_c(OHX02TC, OHX03TC, OHX04TC, OHX05TC, OHX06TC, OHX07TC, OHX08TC,
OHX09TC, OHX10TC, OHX11TC, OHX12TC, OHX13TC, OHX14TC, OHX15TC,
OHX18TC, OHX19TC, OHX20TC, OHX21TC, OHX22TC, OHX23TC, OHX24TC,
OHX25TC, OHX26TC, OHX27TC, OHX28TC, OHX29TC, OHX30TC, OHX31TC),
edentulism = case_when(str_detect(tc, "[4]{28}") ~ 1,
str_detect(tc, "[1-5]{28}") ~ 0)) %>%
select(SEQN, edentulism)
One <- left_join(DEMO, OHXDEN, by = "SEQN")
NHANES <- One %>%
as_survey_design(id = SDMVPSU, strata = SDMVSTRA, nest = TRUE, weight = WTMEC2YR,
survey.lonely.psu = "adjust")
summary(NHANES)
NHANES <- NHANES %>%
filter(!is.na(age) & !is.na(edentulism))
summary(NHANES)
t1 <- NHANES %>%
summarize(gender = "All", age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
group_by(age) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t3 <- NHANES %>%
group_by(gender) %>%
summarize(age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t4 <- NHANES %>%
group_by(gender, age) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table1 <- bind_rows(t1, t2, t3, t4)
ggplot(table1, aes(gender, percent, fill = age)) +
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)),
position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 1. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and age: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 25), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+age, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), NHANES, family = quasibinomial()))$coefficients
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "70-74")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "75 and over")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("70-74", "75 and over")))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), subset(NHANES,
gender == "Women"), family = quasibinomial()))$coefficients
table1 %>%
pivot_wider(names_from = gender, values_from = c(n, percent, percent_se)) %>%
gt() %>%
tab_spanner(label = "All", columns = c(n_All, percent_All, percent_se_All)) %>%
tab_spanner(label = "Men", columns = c(n_Men, percent_Men, percent_se_Men)) %>%
tab_spanner(label = "Women", columns = c(n_Women, percent_Women, percent_se_Women)) %>%
fmt_number(columns = c(n_All, n_Men, n_Women), decimals = 0) %>%
fmt_number(columns = c(percent_All, percent_se_All, percent_Men, percent_se_Men,
percent_Women, percent_se_Women), decimals = 1) %>%
cols_label(age = "Age",
n_All = "n", percent_All = "Percent", percent_se_All = "SE",
n_Men = "n", percent_Men = "Percent", percent_se_Men = "SE",
n_Women = "n", percent_Women = "Percent", percent_se_Women = "SE")
t1 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(race_ethnicity) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(gender, race_ethnicity) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table2 <- bind_rows(t1, t2)
ggplot(table2, aes(gender, percent, fill = race_ethnicity)) +
geom_bar(stat = "identity",
position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)), position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 2. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and race and Hispanic origin: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 32), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+race_ethnicity, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic white"))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic black"))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))$p.value %>% as.numeric()
table2 %>%
pivot_wider(names_from = gender, values_from = c(n, percent, percent_se)) %>%
gt() %>%
tab_spanner(label = "All", columns = c(n_All, percent_All, percent_se_All)) %>%
tab_spanner(label = "Men", columns = c(n_Men, percent_Men, percent_se_Men)) %>%
tab_spanner(label = "Women", columns = c(n_Women, percent_Women, percent_se_Women)) %>%
fmt_number(columns = c(n_All, n_Men, n_Women), decimals = 0) %>%
fmt_number(columns = c(percent_All, percent_se_All, percent_Men, percent_se_Men,
percent_Women, percent_se_Women), decimals = 1) %>%
cols_align(columns = race_ethnicity, align = "left") %>%
cols_label(race_ethnicity = "Race & Hispanic Origin",
n_All = "n", percent_All = "Percent", percent_se_All = "SE",
n_Men = "n", percent_Men = "Percent", percent_se_Men = "SE",
n_Women = "n", percent_Women = "Percent", percent_se_Women = "SE")
t1 <- NHANES %>%
filter(!is.na(education)) %>%
group_by(education) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
filter(!is.na(education)) %>%
group_by(gender, education) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table3 <- bind_rows(t1, t2)
ggplot(table3, aes(gender, percent, fill = education)) +
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)),
position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 3. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and education level: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 42), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+education, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+education, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+education, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
table3 %>%
pivot_wider(names_from = gender, values_from = c(n, percent, percent_se)) %>%
gt() %>%
tab_spanner(label = "All", columns = c(n_All, percent_All, percent_se_All)) %>%
tab_spanner(label = "Men", columns = c(n_Men, percent_Men, percent_se_Men)) %>%
tab_spanner(label = "Women", columns = c(n_Women, percent_Women, percent_se_Women)) %>%
fmt_number(columns = c(n_All, n_Men, n_Women), decimals = 0) %>%
fmt_number(columns = c(percent_All, percent_se_All, percent_Men, percent_se_Men,
percent_Women, percent_se_Women), decimals = 1) %>%
cols_align(columns = education, align = "left") %>%
cols_label(education = "Education Level",
n_All = "n", percent_All = "Percent", percent_se_All = "SE",
n_Men = "n", percent_Men = "Percent", percent_se_Men = "SE",
n_Women = "n", percent_Women = "Percent", percent_se_Women = "SE")
x <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
x
names(x)
x$estimate
x$statistic
(1 - pt(x$statistic, 24)) * 2
x
(1 - pt(x$statistic, 25)) * 2
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
(1 - pt(x$statistic, 29)) * 2
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
(1 - pt(x$statistic, 30)) * 2
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
(1 - pt(x$statistic, 29)) * 2
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
(1 - pt(x$statistic, 30)) * 2
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("%.4f", (1 - pt(x$statistic, 30)) * 2)
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("%.4f", (1 - pt(x$statistic, 29)) * 2)
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("p-value = %.4f", (1 - pt(x$statistic, 30)) * 2)
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("p-value = %.4f", (1 - pt(x$statistic, 30)) * 2)
library(gt)
library(haven)
library(srvyr)
library(survey)
library(tidyverse)
DEMO_I <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2015-2016/demo_i.xpt") %>%
select(SEQN, SDDSRVYR, RIAGENDR, RIDAGEYR, RIDRETH3, DMDEDUC2, SDMVSTRA, SDMVPSU, WTMEC2YR)
DEMO_J <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2017-2018/demo_j.xpt") %>%
select(SEQN, SDDSRVYR, RIAGENDR, RIDAGEYR, RIDRETH3, DMDEDUC2, SDMVSTRA, SDMVPSU, WTMEC2YR)
DEMO <- bind_rows(DEMO_I, DEMO_J) %>%
mutate(
gender = case_when(
RIAGENDR == 1 ~ "Men", RIAGENDR == 2 ~ "Women"),
age = case_when(
RIDAGEYR %in% 65:69 ~ "65-69", RIDAGEYR %in% 70:74 ~ "70-74",
RIDAGEYR >= 75 ~ "75 and over"),
age = factor(age,
levels = c("65-69", "70-74", "75 and over")),
race_ethnicity = case_when(
RIDRETH3 %in% 1:2 ~ "Hispanic", RIDRETH3 == 3 ~ "Non-Hispanic white",
RIDRETH3 == 4 ~ "Non-Hispanic black"),
race_ethnicity = factor(race_ethnicity,
levels = c("Non-Hispanic white", "Non-Hispanic black", "Hispanic")),
education = case_when(
DMDEDUC2 %in% 1:2 ~ "Less than high school education",
DMDEDUC2 %in% 3:5 ~ "High school education or greater"),
education = factor(education,
levels = c("Less than high school education", "High school education or greater"))) %>%
select(SEQN, gender, age, race_ethnicity, education, SDMVSTRA, SDMVPSU, WTMEC2YR)
OHXDEN_I <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2015-2016/ohxden_i.xpt") %>%
select(SEQN, OHX02TC:OHX31TC)
OHXDEN_J <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2017-2018/ohxden_j.xpt") %>%
select(SEQN, OHX02TC:OHX31TC)
OHXDEN <- bind_rows(OHXDEN_I, OHXDEN_J) %>%
mutate(
tc = str_c(OHX02TC, OHX03TC, OHX04TC, OHX05TC, OHX06TC, OHX07TC, OHX08TC,
OHX09TC, OHX10TC, OHX11TC, OHX12TC, OHX13TC, OHX14TC, OHX15TC,
OHX18TC, OHX19TC, OHX20TC, OHX21TC, OHX22TC, OHX23TC, OHX24TC,
OHX25TC, OHX26TC, OHX27TC, OHX28TC, OHX29TC, OHX30TC, OHX31TC),
edentulism = case_when(str_detect(tc, "[4]{28}") ~ 1,
str_detect(tc, "[1-5]{28}") ~ 0)) %>%
select(SEQN, edentulism)
One <- left_join(DEMO, OHXDEN, by = "SEQN")
options(survey.adjust.domain.lonely = TRUE, survey.lonely.psu = "adjust")
NHANES <- One %>%
as_survey_design(id = SDMVPSU, strata = SDMVSTRA, nest = TRUE, weight = WTMEC2YR)
NHANES <- NHANES %>%
filter(!is.na(age) & !is.na(edentulism))
t1 <- NHANES %>%
summarize(gender = "All", age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
group_by(age) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t3 <- NHANES %>%
group_by(gender) %>%
summarize(age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t4 <- NHANES %>%
group_by(gender, age) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table1 <- bind_rows(t1, t2, t3, t4)
ggplot(table1, aes(gender, percent, fill = age)) +
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)),
position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 1. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and age: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 25), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+age, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), NHANES, family = quasibinomial()))$coefficients
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "70-74")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "75 and over")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("70-74", "75 and over")))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), subset(NHANES,
gender == "Women"), family = quasibinomial()))$coefficients
table1 %>%
pivot_wider(names_from = gender, values_from = c(n, percent, percent_se)) %>%
gt() %>%
tab_spanner(label = "All", columns = c(n_All, percent_All, percent_se_All)) %>%
tab_spanner(label = "Men", columns = c(n_Men, percent_Men, percent_se_Men)) %>%
tab_spanner(label = "Women", columns = c(n_Women, percent_Women, percent_se_Women)) %>%
fmt_number(columns = c(n_All, n_Men, n_Women), decimals = 0) %>%
fmt_number(columns = c(percent_All, percent_se_All, percent_Men, percent_se_Men,
percent_Women, percent_se_Women), decimals = 1) %>%
cols_label(age = "Age",
n_All = "n", percent_All = "Percent", percent_se_All = "SE",
n_Men = "n", percent_Men = "Percent", percent_se_Men = "SE",
n_Women = "n", percent_Women = "Percent", percent_se_Women = "SE")
t1 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(race_ethnicity) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(gender, race_ethnicity) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table2 <- bind_rows(t1, t2)
ggplot(table2, aes(gender, percent, fill = race_ethnicity)) +
geom_bar(stat = "identity",
position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)), position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 2. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and race and Hispanic origin: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 32), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+race_ethnicity, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic white"))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic black"))$p.value %>% as.numeric()
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("p-value = %.4f", (1 - pt(x$statistic, 30)) * 2)
library(gt)
library(haven)
library(srvyr)
library(survey)
library(tidyverse)
DEMO_I <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2015-2016/demo_i.xpt") %>%
select(SEQN, SDDSRVYR, RIAGENDR, RIDAGEYR, RIDRETH3, DMDEDUC2, SDMVSTRA, SDMVPSU, WTMEC2YR)
DEMO_J <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2017-2018/demo_j.xpt") %>%
select(SEQN, SDDSRVYR, RIAGENDR, RIDAGEYR, RIDRETH3, DMDEDUC2, SDMVSTRA, SDMVPSU, WTMEC2YR)
DEMO <- bind_rows(DEMO_I, DEMO_J) %>%
mutate(
gender = case_when(
RIAGENDR == 1 ~ "Men", RIAGENDR == 2 ~ "Women"),
age = case_when(
RIDAGEYR %in% 65:69 ~ "65-69", RIDAGEYR %in% 70:74 ~ "70-74",
RIDAGEYR >= 75 ~ "75 and over"),
age = factor(age,
levels = c("65-69", "70-74", "75 and over")),
race_ethnicity = case_when(
RIDRETH3 %in% 1:2 ~ "Hispanic", RIDRETH3 == 3 ~ "Non-Hispanic white",
RIDRETH3 == 4 ~ "Non-Hispanic black"),
race_ethnicity = factor(race_ethnicity,
levels = c("Non-Hispanic white", "Non-Hispanic black", "Hispanic")),
education = case_when(
DMDEDUC2 %in% 1:2 ~ "Less than high school education",
DMDEDUC2 %in% 3:5 ~ "High school education or greater"),
education = factor(education,
levels = c("Less than high school education", "High school education or greater"))) %>%
select(SEQN, gender, age, race_ethnicity, education, SDMVSTRA, SDMVPSU, WTMEC2YR)
OHXDEN_I <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2015-2016/ohxden_i.xpt") %>%
select(SEQN, OHX02TC:OHX31TC)
OHXDEN_J <- read_xpt("https://wwwn.cdc.gov/nchs/nhanes/2017-2018/ohxden_j.xpt") %>%
select(SEQN, OHX02TC:OHX31TC)
OHXDEN <- bind_rows(OHXDEN_I, OHXDEN_J) %>%
mutate(
tc = str_c(OHX02TC, OHX03TC, OHX04TC, OHX05TC, OHX06TC, OHX07TC, OHX08TC,
OHX09TC, OHX10TC, OHX11TC, OHX12TC, OHX13TC, OHX14TC, OHX15TC,
OHX18TC, OHX19TC, OHX20TC, OHX21TC, OHX22TC, OHX23TC, OHX24TC,
OHX25TC, OHX26TC, OHX27TC, OHX28TC, OHX29TC, OHX30TC, OHX31TC),
edentulism = case_when(str_detect(tc, "[4]{28}") ~ 1,
str_detect(tc, "[1-5]{28}") ~ 0)) %>%
select(SEQN, edentulism)
One <- left_join(DEMO, OHXDEN, by = "SEQN")
options(survey.adjust.domain.lonely = TRUE, survey.lonely.psu = "average")
NHANES <- One %>%
as_survey_design(id = SDMVPSU, strata = SDMVSTRA, nest = TRUE, weight = WTMEC2YR)
NHANES <- NHANES %>%
filter(!is.na(age) & !is.na(edentulism))
t1 <- NHANES %>%
summarize(gender = "All", age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
group_by(age) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t3 <- NHANES %>%
group_by(gender) %>%
summarize(age = "Total", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t4 <- NHANES %>%
group_by(gender, age) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table1 <- bind_rows(t1, t2, t3, t4)
ggplot(table1, aes(gender, percent, fill = age)) +
geom_bar(stat = "identity", position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)),
position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 1. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and age: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 25), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+age, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+age, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), NHANES, family = quasibinomial()))$coefficients
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "70-74")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("65-69", "75 and over")))$p.value %>% as.numeric()
svyttest(edentulism~age, subset(NHANES,
gender == "Men" & age %in% c("70-74", "75 and over")))$p.value %>% as.numeric()
summary(svyglm(edentulism~as.numeric(age), subset(NHANES,
gender == "Women"), family = quasibinomial()))$coefficients
table1 %>%
pivot_wider(names_from = gender, values_from = c(n, percent, percent_se)) %>%
gt() %>%
tab_spanner(label = "All", columns = c(n_All, percent_All, percent_se_All)) %>%
tab_spanner(label = "Men", columns = c(n_Men, percent_Men, percent_se_Men)) %>%
tab_spanner(label = "Women", columns = c(n_Women, percent_Women, percent_se_Women)) %>%
fmt_number(columns = c(n_All, n_Men, n_Women), decimals = 0) %>%
fmt_number(columns = c(percent_All, percent_se_All, percent_Men, percent_se_Men,
percent_Women, percent_se_Women), decimals = 1) %>%
cols_label(age = "Age",
n_All = "n", percent_All = "Percent", percent_se_All = "SE",
n_Men = "n", percent_Men = "Percent", percent_se_Men = "SE",
n_Women = "n", percent_Women = "Percent", percent_se_Women = "SE")
t1 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(race_ethnicity) %>%
summarize(gender = "All", n = unweighted(n()), percent = survey_mean(edentulism) * 100)
t2 <- NHANES %>%
filter(!is.na(race_ethnicity)) %>%
group_by(gender, race_ethnicity) %>%
summarize(n = unweighted(n()), percent = survey_mean(edentulism) * 100)
table2 <- bind_rows(t1, t2)
ggplot(table2, aes(gender, percent, fill = race_ethnicity)) +
geom_bar(stat = "identity",
position = position_dodge(), color = "black") +
geom_text(aes(label = sprintf("%.1f", percent)), position = position_dodge(0.9), vjust = -0.2) +
labs(title = paste("Figure 2. Prevalence of complete tooth loss among adults aged 65 and",
"over, by sex and race and Hispanic origin: United States, 2015–2018", sep = "\n"),
x = element_blank(),
y = "Percent",
fill = element_blank()) +
coord_cartesian(ylim = c(0, 32), expand = FALSE) +
scale_fill_brewer(palette = "Blues") +
theme_classic() +
theme(legend.position=c(.5, .95), legend.direction = "horizontal")
svychisq(~edentulism+race_ethnicity, NHANES)$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Men"))$p.value %>% as.numeric()
svychisq(~edentulism+race_ethnicity, subset(NHANES, gender == "Women"))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Men" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Non-Hispanic black")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic white", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~race_ethnicity, subset(NHANES,
gender == "Women" & race_ethnicity %in% c("Non-Hispanic black", "Hispanic")))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic white"))$p.value %>% as.numeric()
svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Non-Hispanic black"))$p.value %>% as.numeric()
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("p-value = %.4f", (1 - pt(x$statistic, 30)) * 2)
t <- svyttest(edentulism~gender, subset(NHANES,
race_ethnicity == "Hispanic"))
t
sprintf("p-value = %.4f", (1 - pt(t$statistic, 30)) * 2)
